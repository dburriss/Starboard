<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Working with metadata</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="Devon Burriss">

    <link rel="stylesheet" id="theme_link" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/4.6.0/materia/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns" crossorigin="anonymous"></script>

    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico">
    <link type="text/css" rel="stylesheet" href="/Overboard/content/navbar-fixed-left.css" />
    <link type="text/css" rel="stylesheet" href="/Overboard/content/fsdocs-default.css" />
    <link type="text/css" rel="stylesheet" href="/Overboard/content/fsdocs-custom.css" />
    <script type="text/javascript" src="/Overboard/content/fsdocs-tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- BEGIN SEARCH BOX: this adds support for the search box -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.css" />
    <!-- END SEARCH BOX: this adds support for the search box -->
    
</head>

<body>
    <nav class="navbar navbar-expand-md navbar-light bg-secondary fixed-left" id="fsdocs-nav">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse navbar-nav-scroll" id="navbarsExampleDefault">
            <a href="/Overboard/"><img id="fsdocs-logo" src="/Overboard/img/logo.png" /></a>
            <!-- BEGIN SEARCH BOX: this adds support for the search box -->
            <div id="header">
                <div class="searchbox" id="fsdocs-searchbox">
                    <label for="search-by">
                        <i class="fas fa-search"></i>
                    </label>
                    <input data-search-input="" id="search-by" type="search" placeholder="Search..." />
                    <span data-search-clear="">
                        <i class="fas fa-times"></i>
                    </span>
                </div>
            </div>

            <!-- END SEARCH BOX: this adds support for the search box -->
            <ul class="navbar-nav">
                <li class="nav-header">Links</li>
                <li class="nav-item" id="fsdocs-license-link"><a class="nav-link" href="https://github.com/dburriss/overboard/License">License</a></li>
                <li class="nav-item" id="fsdocs-release-notes-link"><a class="nav-link" href="https://github.com/dburriss/overboard/blob/master/RELEASE_NOTES.md">Release Notes</a></li>
                <li class="nav-item" id="fsdocs-repository-link"><a class="nav-link" href="https://github.com/dburriss/overboard/">Source Repository</a></li>
                <li class="nav-header">
  How-to
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Overboard/1_setup-environment.html">
    Setup your environment
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Overboard/2_generating-kubernetes-config.html">
    Generating Kubernetes config
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Overboard/3_working-with-metadata.html">
    Working with metadata
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Overboard/4_generate-dynamic-config.html">
    Generate dynamic config
  </a>
</li>             
<li class="nav-header">
  Tutorials
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Overboard/tutorials/hello-world.html">
    Hello world
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Overboard/tutorials/guestbook.html">
    Guestbook
  </a>
</li>
                <li class="nav-header">
  API Reference
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Overboard/reference/index.html">
    All Namespaces
  </a>
</li>
            </ul>
        </div>
    </nav>
    <div class="container">
        <div class="masthead">
            <h3 class="muted"><a href="/Overboard/">Overboard</a></h3>
        </div>
        <hr />
        <div class="container" id="fsdocs-content">
            
<h1><a name="Working-with-metadata" class="anchor" href="#Working-with-metadata">Working with metadata</a></h1>
<p>Setting metadata like <code>name</code>, <code>namespace</code>, <code>labels</code>, and <code>annotations</code> are a common part of defining a Kubernetes resource.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Using an inline metadata builder</span>
<span class="id">k8s</span> <span class="pn">{</span>
    <span class="id">deployment</span> <span class="pn">{</span>
        <span class="id">metadata</span> <span class="pn">{</span>
            <span class="id">name</span> <span class="s">&quot;my-name&quot;</span>
            <span class="id">ns</span> <span class="s">&quot;my-namespace&quot;</span> <span class="c">// `ns` used since namespace is a keyword in F#</span>
            <span class="id">labels</span> <span class="pn">[</span><span class="s">&quot;label1&quot;</span><span class="pn">,</span> <span class="s">&quot;value1&quot;</span><span class="pn">]</span>
            <span class="id">annotations</span> <span class="pn">[</span><span class="s">&quot;annotation-key&quot;</span><span class="pn">,</span> <span class="s">&quot;annotation-value&quot;</span><span class="pn">]</span>
        <span class="pn">}</span>
    <span class="pn">}</span>
<span class="pn">}</span>
</code></pre>
<p>It is of course always possible to pass in a variable instead.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Assign the builder result to a variable first</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="id">meta</span> <span class="o">=</span> <span class="id">metadata</span> <span class="pn">{</span>
            <span class="id">name</span> <span class="s">&quot;my-name&quot;</span>
            <span class="id">ns</span> <span class="s">&quot;my-namespace&quot;</span>
            <span class="id">labels</span> <span class="pn">[</span><span class="s">&quot;label1&quot;</span><span class="pn">,</span> <span class="s">&quot;value1&quot;</span><span class="pn">]</span>
            <span class="id">annotations</span> <span class="pn">[</span><span class="s">&quot;annotation-key&quot;</span><span class="pn">,</span> <span class="s">&quot;annotation-value&quot;</span><span class="pn">]</span>
        <span class="pn">}</span>
<span class="id">k8s</span> <span class="pn">{</span>
    <span class="id">deployment</span> <span class="pn">{</span>
        <span class="id">set_metadata</span> <span onmouseout="hideTip(event, 'fs1', 2)" onmouseover="showTip(event, 'fs1', 2)" class="id">meta</span>
    <span class="pn">}</span>
<span class="pn">}</span>
</code></pre>
<p>A <strong>convention</strong> that is enabled is that you can set the metadata on a resource using any of the following operations <code>_name</code>, <code>_namespace</code>, <code>_labels</code>, and <code>_annotations</code></p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// use the _ convention</span>
<span class="id">k8s</span> <span class="pn">{</span>
    <span class="id">deployment</span> <span class="pn">{</span>
        <span class="id">_name</span> <span class="s">&quot;my-name&quot;</span>
        <span class="id">_namespace</span> <span class="s">&quot;my-namespace&quot;</span>
        <span class="id">_labels</span> <span class="pn">[</span><span class="s">&quot;label1&quot;</span><span class="pn">,</span> <span class="s">&quot;value1&quot;</span><span class="pn">]</span>
        <span class="id">_annotations</span> <span class="pn">[</span><span class="s">&quot;annotation-key&quot;</span><span class="pn">,</span> <span class="s">&quot;annotation-value&quot;</span><span class="pn">]</span>
    <span class="pn">}</span>
<span class="pn">}</span>
</code></pre>
<p>Another <strong>convention</strong> is that instead of using <code>_name</code> you can drop a string into the body of most resources and it will be assigned to the <code>metadata.name</code> property. This also works for some data that does not have metadata but has a name property.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// use the _ convention</span>
<span class="id">k8s</span> <span class="pn">{</span>
    <span class="id">deployment</span> <span class="pn">{</span>
        <span class="s">&quot;my-name&quot;</span> <span class="c">// &lt;- No operation specified</span>
        <span class="id">_labels</span> <span class="pn">[</span><span class="s">&quot;label1&quot;</span><span class="pn">,</span> <span class="s">&quot;value1&quot;</span><span class="pn">]</span>
    <span class="pn">}</span>
<span class="pn">}</span>
</code></pre>
<p>One last neat trick for metadata and many other resources is that you can just drop the variable into the body of the builder. For this to work, the type of the variable must be unique to a single field on the builder.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs2', 3)" onmouseover="showTip(event, 'fs2', 3)" class="id">deploymentMetadata</span> <span class="o">=</span> 
        <span class="id">metadata</span> <span class="pn">{</span>
            <span class="id">name</span> <span class="s">&quot;my-name&quot;</span>
            <span class="id">ns</span> <span class="s">&quot;my-namespace&quot;</span>
            <span class="id">labels</span> <span class="pn">[</span><span class="s">&quot;label1&quot;</span><span class="pn">,</span> <span class="s">&quot;value1&quot;</span><span class="pn">]</span>
            <span class="id">annotations</span> <span class="pn">[</span><span class="s">&quot;annotation-key&quot;</span><span class="pn">,</span> <span class="s">&quot;annotation-value&quot;</span><span class="pn">]</span>
        <span class="pn">}</span>

<span class="c">// use the _ convention</span>
<span class="id">k8s</span> <span class="pn">{</span>
    <span class="id">deployment</span> <span class="pn">{</span>
        <span onmouseout="hideTip(event, 'fs2', 4)" onmouseover="showTip(event, 'fs2', 4)" class="id">deploymentMetadata</span> <span class="c">// &lt;- just drop the variable in the resource expression</span>
    <span class="pn">}</span>
<span class="pn">}</span>
</code></pre>
<p>So there are many ways to define your metadata. I suggest you decide for one on your project and use that method throughout.</p>

            <div class="fsdocs-tip" id="fs1">val meta: obj</div>
<div class="fsdocs-tip" id="fs2">val deploymentMetadata: obj</div>

        </div>

        <!-- BEGIN SEARCH BOX: this adds support for the search box -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.css" />
        <script type="text/javascript">var fsdocs_search_baseurl = '/Overboard/';</script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.8/lunr.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.min.js"></script>
        <script type="text/javascript" src="/Overboard/content/fsdocs-search.js"></script>
        <!-- END SEARCH BOX: this adds support for the search box -->
    </div>
</body>

</html>